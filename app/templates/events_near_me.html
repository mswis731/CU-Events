{% extends 'navbar.html' %}

{% block title %} - Events Near Me{% endblock %}

{% block stylesheets %}
{% endblock %}


{% block content %}
<div class="container">
	<div class="col-md-4" >
		<form action="", method="post">
			<div class="form-group row">
					{{ form.radius.label }}
					{{ form.radius(class="selectpicker col-sm-4") }}
					{{ form.limit.label }}
					{{ form.limit(class="selectpicker col-sm-3") }}
					{{ form.submit(class="btn btn-primary") }}
			</div>
			<div class="form-group row">
				<div class="list-group" style="overflow:scroll; height:460px">
					{% for marker in markers %}
					<a href="{{ url_for('get_event', id=marker.eid) }}" class="list-group-item">{{ loop.index }}. {{ marker.title }}<span class="pull-right">{{'%0.2f'| format(marker.dist|float)}} mi</span></a>
					{% endfor %}
				</div>
			</div>
		</form>
	</div>
	<div class="col-md-8" >
		<div id="map" style="width: 600px; height: 600px;"></div>
	</div>
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-marker-clusterer/1.0.0/markerclusterer.js"></script>
<script type="text/javascript">
$(document).ready(function(){
/*
	function initialize() {
		var center = new google.maps.LatLng({{ user_loc.lat }}, {{ user_loc.lng }});
		var map = new google.maps.Map(document.getElementById('map'), {
    		zoom: 12,
    		zoomControl : true,
    		zoomControlOpt: {
        		style : 'SMALL',
        		position: 'TOP_LEFT'
    		},
    		panControl : false,
    		center: center,
    		mapTypeId: google.maps.MapTypeId.ROADMAP
  		});
  		var markers = [];
		{% for marker in markers %}
		markers.push(new google.maps.Marker({
						position: new google.maps.LatLng({{ marker.loc.lat }}, {{ marker.loc.lng }}),
  						title: '{{ marker.title}}'
		}));
		{% endfor %}
		var options = {
	    	imagePath: 'static/images/m'
		};
		var markerCluster = new MarkerClusterer(map, markers, options);
	}

	google.maps.event.addDomListener(window, 'load', initialize);
*/
	var map = new GMaps({
		el: '#map',
    	lat: {{ user_loc.lat }},
    	lng: {{ user_loc.lng }},
    	zoom: 12,
    	zoomControl : true,
    	zoomControlOpt: {
        	style : 'SMALL',
        	position: 'TOP_LEFT'
    	},
    	panControl : false,
  	});
	{% for marker in markers %}
	map.addMarker({
  		lat: {{ marker.loc.lat }},
  		lng: {{ marker.loc.lng }},
  		title: '{{ marker.title}}'
	});
	{% endfor %}
});
</script>
{% endblock %}
